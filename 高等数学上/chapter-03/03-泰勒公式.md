## 第三章 微分中值定理与导数的应用



### 第三讲 泰勒公式



本章例题

例 求下列函数带有拉格朗日余项的 n 阶麦克劳林公式

$f(x) = e^x$ 		$f(x) = \sin{x}$ 		$f(x) = \cos{x}$		$f(x) = \ln{(1 + x)}$



例 求出函数 $f(x) = \ln{x}$ 在点 x = 3 处带有佩亚诺余项的三阶泰勒公式



例 计算 $\displaystyle \lim_{x \to 0} \frac{e^{x^2} + 2\cos{x} - 3}{x^4}$



例 设函数 $f(x)$ 在闭区间 [-1, 1] 上具有三阶连续导数，且 $f(-1) = 0，f(1) = 1，f'(0) = 0$, 证明开区间(-1, 1) 内至少存在一点 $\xi$，使得 $f'''(\xi) = 3$





**引例：如何计算函数$f(x)$在一点$x=x_0$处，当自变量增量 $\Delta x \to 0$ 时的函数增量$\Delta y$??**

1) $\Delta y = f(x_0+\Delta x) - f(x_0)$

`往往当函数 f(x) 过于复杂时，上式的计算较为麻烦，为了使计算更加简单，引入微分进行近似计算`

2) $\Delta y \approx dy = f'(x_0)dx$

$实际上，只有当 \Delta x 十分小时，上式才较为精确，不过它的误差较难计算出来$

3) $\Delta y =  f(x_0+\Delta x) - f(x_0) = f'(x + \theta\Delta x)\Delta x，0 < \theta < 1$

$通过有限增量公式可以得到函数增量的准确值，不过却无法在实际中使用，因为 \theta 无法选择$





<p style="color:blue;font-weight:bold">泰勒公式<p>
**泰勒中值定理1 如果函数 $f(x)$ 在 $x_0$ 处具有 n 阶导数，那么存在 $x_0$ 的一个领域，对于该领域内的任意x，有**

**$f(x) = f(x_0) + f'(x_0)(x-x_0) + \frac{f''(x_0)}{2!}(x-x_0)^2 + ... + \frac{f^{(n)}(x_0)^n}{n!}(x-x_0)^n + R_n(x)$**

**其中 $R_n(x) = o((x - x_0)^n)$**

> 证明
>
> 要找到 f(x) 的精确表示，且满足该表达式足够建档
>
> 不妨设  $f(x) = P_n(x) + R_n(x)$，其中 $P_n(x)$是表达式的有限部分，$R_n(x)$ 是表达式的无限部分
>
> 由于
>
> 	1. 若在 $x_0$ 相交，则有 $P_n(x_0) = f(x_0)$
> 	2. 若在 $x_0$ 有相同得切线，则有 $P_n'(x_0) = f'(x_0)$
> 	3. 若弯曲方向相同，则有$P_n''(x_0) = f''(x_0)$
> 	4. ......
>
> 可设 $P_n(x) = a_0 + a_1(x-x_0)+a_2(x-x_0)^2 + ... + a_n(x-x_0)^n$
>
> 则要使得 $\begin{cases} f(x_0) = P_n{(x_0)} \\f'(x_0) = p_n'(x_0) \\f''(x_0) = p_n''(x_0) \\ f'''(x_0) = P_n'''(x_0) \\ ...\\ f^{(n)}(x_0) = p_n^{(n)}(x_0) \end{cases}$-----（1）  代入上式，可解得 $\begin{cases} a_0 = f(x_0) \\ a_1 = f'(x_0) \\ a_2 = \frac{f''(x_0)}{2!} \\ a_3 = \frac{f'''(x_0)}{3!} \\ ... \\ a_n = \frac{f^{(n)}(x_0)}{n!} \end{cases}$
>
> 综上可得
>
>  $P_n(x) = f(x_0) + f'(x_0)(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2 + ... + \frac{f^{(n)}(x_0)}{n!}(x-x_0)^n$
>
> $f(x) = P_n(x) + R_n(x)$
>
> 
>
> 下证明  $R_n(x) = o((x - x_0)^n)$
>
> 由于 $R_n(x) = f(x) - P_n(x)$
>
> 且由 (1) 可知 $R_n(x_0) = R_n'(x_0)= R_n''(x_0)= R_n'''(x_0) = ... = R_n^{(n)}(x_0) = 0 $
>
> 由于 $f(x)$ 在 $x_0$ 处具有 n 阶导数，因此 $f(x)$ 必在 $x_0$ 的某领域内存在(n - 1) 阶导数，从而 $R_n(x)$ 也在该领域内(n - 1) 阶可导，反复利用洛必达法则
>
> $\displaystyle \lim_{x \to x_0}\frac{R_n{x}}{(x - x_0)^n} = \lim_{x \to x_0}\frac{R_n'(x)}{n(x - x_0)^{n -1}} = \lim_{x \to x_0}\frac{R_n''(x)}{n(n - 1)(x - x_0)^{n - 2}}$
>
> ​					$ = ... = \displaystyle \lim_{x \to x_0}\frac{R_n^{(n - 1)}(x)}{n!(x - x_0)}$
>
> ​					$=\frac{1}{n!}\displaystyle \lim_{x\to x_0}\frac{R_n^{(n-1)}(x) - R_n^{(n-1)}(x_0)}{x - x_0}$
>
> ​					$ = \frac{1}{n!}R_n^{(n)}(x_0) = 0$
>
> 因此 $R_n(x) = o((x - x_0)^n)$





**补充定理1**

**$f(x) = f(x_0) + f'(x_0)(x-x_0) + \frac{f''(x_0)}{2!}(x-x_0)^2 + ... + \frac{f^{(n)}(x_0)^n}{n!}(x-x_0)^n + o((x - x_0)^n)$**

该公式被称为 $f(x) 在 x_0$ 处带有佩亚诺余项的n阶泰勒公式

$R_n(x) = o((x - x_0)^{n})$ 称为佩亚诺余项



多项式 $P_n(x) = f(x_0) + f'(x_0)(x-x_0)+\frac{f''(x_0)}{2!}(x-x_0)^2 + ... + \frac{f^{(n)}(x_0)}{n!}(x-x_0)^n$

称为函数 f(x) 在 $x_0$ 处的 n 次泰勒多项式



如果在泰勒公式中取 $x_0 = 0$，得到带有佩亚诺余项的麦克劳林公式

$f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + ... + \frac{f^{(n)}(0)}{n!}x^n + o(x^n)$





**泰勒中值定理2 如果函数$f(x)$ 在$x_0$ 的某个领域 $U(x_0)$ 内具有(n + 1) 阶导数，那么对于任意$x \in U(x_0)$ 有**

**$f(x) = f(x_0) + f'(x_0)(x-x_0) + \frac{f''(x_0)}{2!}(x-x_0)^2 + ... + \frac{f^{(n)}(x_0)}{n!}(x - x_0)^n + R_n(x)$**

**其中 $R_n(x) = \frac{f^{(n + 1)}(\xi)}{(n + 1)!}(x - x_0)^{n + 1}$，这里 $\xi$ 是$x_0$ 与 x 之间的某个值**



> 证 
>
> 由于 $R_n(x) = f(x) - P_n(x)$
>
> 且由 (1) 可知 $R_n(x_0) = R_n'(x_0)= R_n''(x_0)= R_n'''(x_0) = ... = R_n^{(n)}(x_0) = 0 $
>
> 
>
> 函数 $R_n(x)$ 及 $(x - x_0)^{n + 1}$ 在以 $x_0$ 及 x 为端点的区间上满足柯西中值定理的条件，应用柯西中值定理，得
>
> $\frac{R_n(x)}{(x - x_0)^{n + 1}} = \frac{R_n(x) - R_n(x_0)}{(x - x_0)^{n + 1} - 0}  = \frac{R_n'(\xi_1)}{(n + 1)(\xi_1 - x_0)^n} = \frac{R_n'(\xi_1) - R_n'(x_0)}{(n + 1)(\xi_1 - x_0)^n - 0} = \frac{R_n''(\xi_2)}{n(n + 1)(\xi_2 - x_0)^{n-1}}$
>
> 照此方法继续下去，经过 ( n + 1 ) 次后，得到
>
> $\frac{R_n(x)}{(x - x_0)^{n + 1}} = \frac{R_n^{(n + 1)}(\xi)}{(n + 1)!}$  ($\xi$ 在 $x_0$ 与 $\xi_n$ 之间)
>
> 注意到 $R_n^{(n + 1)}(x) = f^{(n + 1)}(x)$
>
> $R_n(x) = \frac{f^{(n + 1)}(\xi)}{(n + 1)!}(x - x_0)^{n + 1}$



**补充定理2**

**$f(x) = f(x_0) + f'(x_0)(x-x_0) + \frac{f''(x_0)}{2!}(x-x_0)^2 + ... + \frac{f^{(n)}(x_0)^n}{n!}(x-x_0)^n + \frac{f^{(n + 1)}(\xi)}{(n + 1)!}(x - x_0)^{n + 1}$**

该公式被称为 $f(x) 在 x_0$ 处带有拉格朗日余项的n阶泰勒公式

$R_n(x) = \frac{f^{(n + 1)}(\xi)}{(n + 1)!}(x - x_0)^{n + 1}$ 称为拉格朗日余项



如果存在正整数 M , 使得当$x \in (a, b)$ 时，恒有

$|f^{(n + 1)}(x)| \le M$

则 $\displaystyle \lim_{x \to x_0}\frac{R_n(x)}{(x - x_0)^n} = \lim_{x \to x_0}\frac{f^{(n + 1)}(\xi)}{(n + 1)!} = 0$

$R_n(x)$ 是比 $(x - x_0)^n$ 高阶的无穷小量，且有误差估计式

$|R_n(x)| \le \frac{M}{(n + 1)!}|x - x_0|^{n + 1}$



如果泰勒公式中取 $x_0 = 0$ 得到带有拉格朗日余项的麦克劳林公式

$f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + ... + \frac{f^{(n)}(0)}{n!}x^n + \frac{f^{(n + 1)}(\theta x)}{(n+1)!}x^{n + 1}$



当 n = 0 时，泰勒公式即是拉格朗日中值公式

$f(x) = f(x_0) + f'(\xi)(x - x_0)$ （$\xi$ 在 $x_0$ 与 x 之间）





<p style="color:blue;font-weight:bold">泰勒公式的应用<p>
例 求下列函数带有拉格朗日余项的 n 阶麦克劳林公式



$f(x) = e^x$ 

>  解 
>
>  $\because f(x) = f'(x) = f''(x) = ... = f^{(n)}(x) = e^x$
>
>  $\therefore f(0) = f'(x) = f''(0) = ... = f^{(n)}(0) = 1$
>
>  $f(x) = 1 + x + \frac{x^2}{2!} + ... + \frac{x^n}{n!} + \frac{e^{\xi}x^{n + 1}}{(n+1)!} \quad \xi \in \mathring{U}(0, x)$





$f(x) = \sin{x}$ 

>  $\because f(x) = \sin{x}，f'(x) = \cos{x}，f''(x) = -\sin{x}，f'''(x) = -\cos{x}，f^{(4)}(x) = \sin{x}$
>
>  $\therefore f(0) = 0，f'(0) =1，f''(0) = 0，f'''(0) = -1，f^{(4)}(0) = 0$
>
>  $f(x) = x - \frac{x^3}{3!} + \frac{x^5}{5!} + ... + (-1)^{n -1} \frac{x^{2n -1}}{(2n -1)!} + R_{2n}(x), \quad (0 < \theta < 1)$
>
>  $R_{2n} = \frac{\sin{[\theta x + (2n + 1)\frac{\pi}{2}]}·x^{2n+1}}{(2n + 1)!} \quad (0 < \theta < 1)$



$f(x) = \cos{x}$

> $\because f(x) = \cos{x}，f'(x) = -\sin{x}，f''(x) = -\cos{x}，f'''(x) = \sin{x}，f^{(4)}(x) = \cos{x}$
>
> $\therefore f(0) = 1，f'(0) =0，f''(0) = -1，f'''(0) = 0，f^{(4)}(0) = 1$
>
> $f(x) = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} + ... + (-1)^n\frac{x^{2n}}{2n}+ R_{2n+1}$
>
> $R_{2n+1}(x) = \frac{\cos{[\theta x + (n + 1)\pi]}·x^{2n + 2}}{(2n+2)!} \quad (0 < \theta < 1)$



$f(x) = \ln{(1 + x)}$

>  $\because f(x) = \ln{(1 + x)}，f'(x) = \frac{1}{1 + x}，f''(x) = -\frac{1}{(1 + x)^2}，f'''(x) = \frac{2}{(1 + x)^3}，...\\ f^{(n)}(x) = (-1)^{n + 1}\frac{n -1}{(1 + x)^n}，f^{(n+1)}(x) = (-1)^{n + 2}\frac{n}{(1 + x)^{n + 1}}$
>
> $\therefore f(0) = 0，f'(0) = 1，f''(0) = -1，f'''(0) = 2，... f^{(4)}(0) = -3$
>
> $f(x) = x - \frac{x^2}{2} + \frac{x^3}{3} + ... + (-1)^{n - 1}\frac{x^n}{n} + (-1)^{n}\frac{x^{n + 1}}{(1 + \theta x)(n + 1)}\quad (0 < \theta < 1)$



  

例 求出函数 $f(x) = \ln{x}$ 在点 x = 3 处带有佩亚诺余项的三阶泰勒公式

>  解 由 $\ln{(1 + x)} = x - \frac{x^2}{2} + \frac{x^3}{3} + ... + (-1)^{n - 1}\frac{x^n}{n} + o(x^n)$
>
>  原式$ = \ln{[3(1 + \frac{x - 3}{3})]} = \ln{3} + \ln(1 + \frac{x - 3}{3})$
>
>  ​		$=\ln{3} + \frac{x - 3}{3} - \frac{1}{2}·(\frac{x - 3}{3})^2 + \frac{1}{3}·(\frac{x - 3}{3})^3 + o((x - 3)^3)$
>
>  ​		$=\ln{3} + \frac{1}{3}(x - 3) - \frac{1}{2}·\frac{1}{3^2}·(x - 3)^2 + \frac{1}{3}·\frac{1}{3^3}(x - 3)^3 + o((x - 3)^3)$





例 计算 $\displaystyle \lim_{x \to 0} \frac{e^{x^2} + 2\cos{x} - 3}{x^4}$

>  分析 由于分母是 $x^4$, 将分子中的 $e^{x^2}, \cos{x}$ 分别用带有佩亚诺余项的四阶麦克劳林公式表示，即
>
> $e^{x^2} = 1 + x^2 + \frac{x^4}{2!} + o(x^4)$
>
> $\cos{x} = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} + o(x^4)$
>
> 原式$=\displaystyle \lim_{x\to0}\frac{\big(1 + x^2 + \frac{x^4}{2!} + o(x^4)\big)+ 2\big(1 - \frac{x^2}{2!} + \frac{x^4}{4!} + o(x^4) \big)-3}{x^4} $
>
> ​		$= \displaystyle \lim_{x\to0}\frac{\frac{7x^4}{12} + o(x^4)}{x^4} = \frac{7}{12}$





例 设函数 $f(x)$ 在闭区间 [-1, 1] 上具有三阶连续导数，且 $f(-1) = 0，f(1) = 1，f'(0) = 0$, 证明开区间(-1, 1) 内至少存在一点 $\xi$，使得 $f'''(\xi) = 3$

>  解 将函数 $f(x)$ 在 x = 0 处展开为二阶泰勒公式
>
>  $f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + \frac{f'''(\xi)}{3!}x^3 \qquad \xi \in \mathring{U}(0, x)$
>
>   代入 x = -1，x = 1 得
>
>  $f(-1) = 0 = f(0) - f'(0) + \frac{f''(0)}{2!} - \frac{f'''(\xi_1)}{3!}，\xi \in (-1, 0)$
>
>  $f(1) = f(0) + f'(0) + \frac{f''(0)}{2!} + \frac{f'''(\xi_2)}{3!}，\xi \in (0, 1)$
>
>  两式相减，得
>
>  $\frac{f'''(\xi_1) + f'''(\xi_2)}{6} = 1$
>
>  即$\frac{f(\xi_1) + f'''(\xi_2)}{2} = 3$
>
>  由已知函数 f(x) 在闭区间 [-1, 1] 上具有三阶连续导数，则存在最大值M，最小值m,使得 $m \le \frac{f(\xi_1) + f'''(\xi_2)}{2} = 3 < M$
>
>  由介值定理，在开区间$(\xi_1, \xi_2) \subset(-1, 1)$ 内至少存在一点 $\xi$ , 使得 $f'''(\xi) = 3$









